%====================================================================

%FIGURE: distribution of mock data in action and configuration space

\begin{figure*}[!htbp]
\plotone{figs/kks2WedgeEx_mockdata.eps}
\caption{Distribution of mock data in action space (2D iso-density contours, enclosing 80\% of the stars, the two central and the lower left panels) and configuration space (1D histograms, right panels), depending on shape and position of a wedge-like survey observation volume (upper right panel) and temperature of the stellar population (indicated in the legend). The \pmodel{} of the mock data, created in the \texttt{KKS-Pot} potential, are given as Test \ref{test:kks2WedgeEx} in Table \ref{tbl:tests}. The distribution in action space visualizes how orbits with different actions reach into different regions within the Galaxy. The 1D histograms on the right illustrate that qDFs generate realistic stellar distributions in Galactocentric coordinates $(R,z,\phi,v_R,v_z,vT)$. \Jo{[TO DO: Jo suggests to make two or three separate figures out of this. I'm not yet convinced, as I think it is nice and tidy like this.]}} 
\label{fig:kks2WedgeEx}
\end{figure*}


%===========================================================================================================================================================================================


\subsection{Mock Data} \label{sec:mockdata}

We will rely on mock data as input to explore the limitations of the modelling. We assume that the positions and velocities of our stellar mock sample are indeed drawn from our assumed family of potentials and DFs (with given parameters $p_\Phi$ and $p_\text{DF}$). The DF is in terms of actions, while the transformation $(\vect{x}_i,\vect{v}_i) \longrightarrow \vect{J}_i$ is computationally much less expensive than the inversion. We therefore employ the following effective two-step method for creating mock data, which also accounts for a survey SF.

In the first step we draw stellar positions $\vect{x}_i$. We start by setting up the interpolation grid for the tracer density $\rho(R,|z| \mid p_\Phi, p_\text{DF})$ generated according to Section \ref{sec:qDF}.\footnote{For the creation of the mock data we use $N_x = 20$, $N_v = 40$ and $n_\sigma=5$ in Equation \ref{eq:tracerdensity}.} Next, we sample random positions $(R_i,z_i,\phi_i)$ uniformly within the observable volume. Using a Monte Carlo rejection method we then shape the sample to follow $\rho(R,|z| \mid p_\Phi, p_\text{DF})$. To apply a non-uniform SF$(\vect{x})$, we use the rejection method a second time. The resulting set of positions $\vect{x}_i$ follows the distribution$p(\vect{x}) \propto \rho_\text{DF}(R,|z| \mid p_{\Phi},p_\text{DF}) \times \text{SF}(\vect{x})$.

In the second step we draw velocities $\vect{v}_i$. For each of the positions $(R_i,z_i)$ we first sample velocities from a Gaussian envelope function in velocity space which is then shaped towards DF$(\vect{J}[R_i,z_i,\vect{v} \mid p_{\Phi}] \mid p_\text{DF})$ using a rejection method. We now have a mock data set satisfying $(\vect{x}_i,\vect{v}_i) \longrightarrow p(\vect{x},\vect{v}) \propto \text{DF}(\vect{J}[\vect{x},\vect{v} \mid p_{\Phi}] \mid p_\text{DF}) \times \text{SF}(\vect{x})$.

%====================================================================

Figure \ref{fig:kks2WedgeEx} shows examples of mock data sets in configuration space $(\vect{x},\vect{v})$ and action space. The mock data from the qDF lead to the expected distributions in configuration space. The distribution in action space illustrates the intuitive physical meaning of actions: The stars of the \texttt{cool} population have in general lower radial and vertical actions, as they are on more circular orbits. Circular orbits with $J_R = 0$ and $J_z = 0$ can only be observed in the Galactic mid-plane. The different ranges of angular momentum $L_z$ in the two example observation volumes reflect $L_z \sim R  \times v_\text{circ}$ and the volumes' different radial extent. The volume at larger $z$ contains stars with higher $J_z$.  An orbit with $L_z \ll$ or $\gg L_z(R_\odot)$ can only reach into a volume at $\sim R_\odot$, if it is more eccentric and has therefore larger $J_R$. This together with the effect of asymmetric drift explains the asymmetric distribution of $J_R$ vs. $L_z$ in Figure \ref{fig:kks2WedgeEx}.


Measurement uncertainties can be added to the mock data by applying the following modifications to the above procedure. We assume Gaussian errors in the heliocentric phase-space coordinates $\tilde{\vect{x}} = (\text{RA},\text{DEC},(m-M)), \tilde{\vect{v}} = (\mu_\text{RA},\mu_\text{DEC},v_\text{los})$ (see Section \ref{sec:coordinates}), where we have taken $(m-M)$ as a proxy for distance. In the case of distance uncertainties $\delta(m-M)$, stars virtually scatter in and out of the observed volume. To account for this, we draw the \emph{true} $\vect{x}_i$ from a volume that is larger than the actual observation volume, perturb the $\vect{x}_i$ according to the position uncertainties and then reject all stars that lie now outside of the observed volume. This mirrors the Poisson scatter around the detection threshold for stars whose distances are determined from the apparent brightness and the distance modulus. We then sample \emph{true} $\vect{v}_i$ (given the \emph{true} $\vect{x}_i$) as described above and perturb them according to the velocity uncertainties.

