\subsection{Mock Data} \label{sec:mockdata}

One goal of this work is to test how the loss of information in the process of measuring stellar phase-space coordinates can affect the outcome of the modelling. To investigate this, we assume first that our measured stars do indeed come from our assumed families of potentials and distribution functions and draw mock data from a given true distribution. In further steps we can manipulate and modify these mock data sets to mimick observational effects.\\
The distribution function is given in terms of actions and angles. The transformation $(\vect{J}_i,\vect{\theta}_i) \longrightarrow (\vect{x}_i,\vect{v}_i)$ is however difficult to perform and computationally much more expensive than the transformation $(\vect{x}_i,\vect{v}_i) \longrightarrow (\vect{J}_i,\vect{\theta}_i)$. We propose a fast and simple two-step method for drawing mock data from an action distribution function, which also accounts effectively for a given survey selection function.


\paragraph{Preparation: Tracer density.} We first setup the interpolation grid for the tracer density $\rho(R,|z| \mid p_\Phi, p_\text{DF})$ generated by the given qDF and according to \S\ref{sec:qDF} and Eq. \ref{eq:tracerdensity}. For the creation of the mock data we use $N_\text{spatial} = 20$, $N_\text{velocity} = 40$ and $N_\text{sigma}=5$.

\paragraph{Step 1: Drawing positions from the selection function.} To get positions $\vect{x}_i$ for our mock data stars, we first sample random positions $(R_i,z_i,\phi_i)$ uniformly from the observed volume. Then we apply a rejection Monte Carlo method to these positions using the pre-calculated $\rho_\text{DF}(R,|z| \mid p_{\Phi},p_\text{DF})$. In an optional third step, if we want to apply a non-uniform selection function, sf$(\vect{x}) \neq $ const. within the observed volume, we use the rejection method a second time. The sample then follows 
\begin{equation*}
\vect{x}_i \longrightarrow p(\vect{x}) \propto \rho_\text{DF}(R,z \mid p_{\Phi},p_\text{DF}) \times \text{sf}(\vect{x}).
\end{equation*}

\paragraph{Step 2: Drawing velocities according to the distribution function.} The velocities are independent of the selection function and observed volume. For each of the positions $(R_i,z_i)$ we now sample velocities directly from the qDF$(R_i,z_i,\vect{v} \mid p_{Phi},p_\text{DF})$ using a rejection method. To reduce the number of rejected velocities, we use a Gaussian in velocity space as an envelope function, from which we first randomly sample velocities and then apply the rejection method to shape the Gaussian velocity distribution towards the velocity distribution predicted by the qDF. We now have a mock data set according to the required:
\begin{equation*}
(\vect{x}_i,\vect{v}_i) \longrightarrow p(\vect{x},\vect{v}) \propto \text{qDF}(\vect{x},\vect{v} \mid p_{\Phi},p_\text{DF}) \times \text{sf}(\vect{x}).
\end{equation*} 

%====================================================================

\paragraph{Example:} Fig. \ref{fig:mockdatadistr} shows examples of mock data sets in configuration space $(\vect{x},\vect{v})$ and action space.  The qDF represents realistic stellar distributions in position-velocity space: More stars are found at smaller $R$ and $|z|$, and are distributed uniformly in $\phi$ according to our assumption of axisymmetry. The distribution in radial and vertical velocities, $v_R$ and $v_z$, is approximately Gaussian with the (total projected) velocity dispersion being $\sim\sigma_{R,0}$ and $\sim\sigma_{z,0}$ (see Table \ref{tbl:referenceMAPs}). The distribution of tangential velocities $v_T$ is skewed because of asymmetric drift [TO DO: Find out, if we need an explanation for asymmetric drift here]
\\The distribution in action space demonstrates the intuitive physical meaning of actions: The stars of the "cool" \MAP have in general lower radial and vertical actions, as they are on more circular orbits. The different relative distributions of the radial and vertical actions $J_R$ and $J_z$ of the "hot" and "cool" \MAP is due to them having different velocity anisotropy $\sigma_{R,0}/\sigma_{z,0}$. The different ranges of angular momentum $L_z$ in the two volumes reflect $L_z \sim R  v_\text{circ}$ and the different radial extent of both volumes. The volume above the plane contains more stars with higher $J_z$, because stars with small $J_z$ can't reach that far above the plane. Circular orbits with $J_R = 0$ and $J_z = 0$ can only be observed in the Galactic mid-plane. An orbit with $L_z$ much smaller or larger than $\L_z(R_\odot)$ can only reach into a volume located around $R_\odot$, if it is more eccentric and has therefore larger $J_R$. This together with the effect of asymmetric drift can be seen in the asymmetric distribution of $J_R$ in the top central panel of Fig. \ref{fig:mockdatadistr}. [TO DO: Part of this could also be mentioned in the figure caption.]

%Explanation for asymmetric drift at a given radius: 1) density profile: more stars inside as compared to outside. stars from inside come from smaller radius and are currently at their apocenter --> slower as circular velocity. --> more likely to be observed as stars from outside at their pericenter. 2) dispersion profile: stars on larger radii are on more circular orbits, because lower velocity dispersion. --> there are even less pericenter stars from the outside in the sample. more stars on non-circular orbits in the inside --> more likely to reach out.


%====================================================================

%FIGURE: distribution of mock data in action and configuration space

\begin{figure}[H]
\plotone{figs/kks2WedgeEx_mockdata.eps}
\caption{Distribution of mock data in action space (2D iso-density contours enclosing 80\% of the stars, in the two central and the lower left panel) and configuration space (1D histograms in right panels), depending on shape and position of observation volume and temperature of the stellar population. The parameters of the mock data model is given as Test \textcircled{1} in Table \ref{tbl:tests}. In the upper left panel we demonstrate the shape of the two different observation volumes within which we were creating each a "hot" (red) and "cool" (blue) mock data set: a large volume centered on the Galactic plane (solid lines) and a smaller one above the plane (dashed lines).} 
\label{fig:mockdatadistr}
\end{figure}
%
%\paragraph{[TO DO] Stuff to explain about fig. \ref{fig:mockdatadistr}:} Shift description of action space from caption to here. Mention, that the distribution according to the qdf in configuration space is indeed how expected: More stars at lower R and lower $|z|$, uniform in $\phi$. Using the velocity dispersion (with $\sigma_0$ being indeed the velocity dispersion at the sun) as integration ranges over $v_R$ and $v_z$ is fine. Maybe overplot $\pm5\sigma_0$ range? For $v_T$ distribution: Explain asymmetric drift. Would $v_T$ for a potential with perfectly flat rotation curve peak at 230km/s? This potential has only an approximately flat rotation curve.\\Cool and hot have different anisotropy --> difference between cool and hot in $J_R$ and $J_z$ is therefore different. \\Asymmetric drift at a given radius: 1) density profile: more stars inside as compared to outside. stars from inside come from smaller radius and are currently at their apocenter --> slower as circular velocity. --> more likely to be observed as stars from outside at their pericenter. 2) dispersion profile: stars on larger radii are on more circular orbits, because lower velocity dispersion. --> there are even less pericenter stars from the outside in the sample. more stars on non-circular orbits in the inside --> more likely to reach out.

%===========================================================================================================================================================================================


\paragraph{Introducing measurement errors.} If we want to add measurement errors to the mock data, we need to apply two modifications to the above procedure.
\\First, measurement errors are best described in the phase-space of observables. We use the heliocentric coordinate system right ascension and declination $(\alpha,\delta)$ and distance modulus $(m-M)$ as proxy for the distance from the sun, the proper motion in both $\alpha$ and $\delta$ direction $(\mu_\alpha,\mu_\delta)$ and the line-of-sight velocity $v_\text{los}$. For the conversion between these observables and the Galactocentric cylindrical coordinate system in which the analysis takes place, we need the position and velocity of the sun, which we set for simplicity in this study to be $(R_\odot,z_\odot)=(8,0)$ kpc and $(v_R,v_T,v_z)=(0,230,0)$ km s$^{-1}$. We assume Gaussian measurement errors in the observables $\tilde{\vect{x}} = (\alpha,\delta,(m-M)), \tilde{\vect{v}} = (\mu_\alpha,\mu_\delta,v_\text{los})$.
\\Second, in the case of distance errors, stars can virtually scatter in and out of the observed volume. To account for this, we first draw "true" positions from a volume that is larger than the actual observation volume, perturb the stars positions according to the distance errors and then reject all stars that lie now outside of the observed volume. This procedure mirrors the Poisson scatter around the detection threshold for stars whose distances are determined from the apparent brightness and the distance modulus. [TO DO: Can I say it like this???] We then sample velocities (given the "true" positions of the stars) as described above and perturb them according to the measurement errors as well.

