\section{Summary and discussion} \label{sec:discussionsummary}

%Setting the Context
Recently, implementations of action DF-based modelling of 6D data in the Galactic disk have been put forth, in part to lay the ground-work fo Gaia (BR13; \citealt{,2013MNRAS.433.1411M,2014MNRAS.445.3133P,2015MNRAS.449.3479S}).

%Everything in a nutshell
We present \RM{}, an improved implementation of the dynamical modelling machinery of BR13, to recover the MW's gravitational potential by fitting an orbit distribution function to stellar populations within the Galactic disk. In this work we investigated the capabilities, strengths and weaknesses of \RM{} by testing its robustness against the breakdown of some of its assumptions---for well-defined, isolated test cases using mock data. Overall the method works very well and is reliable, even when there are small deviations of the model assumptions from the real world Galaxy.

%The RM code
\RM{} applies a full likelihood analysis and is statistically well-behaved. It goes beyond BR13 by allowing for a straightforward and flexible implementation of different model families for potential and DF. It also accounts for selection effects by using full 3D selection functions (given some symmetries).\\

\noindent {\bf Computational speed:~} Large data sets in the age of Gaia require increasingly accurate likelihood evaluations and flexible models. To be able to deal with these computational demands, we sped up the \RM{} code by combining a nested grid approach with MCMC and by faster action calculation using the St\"{a}ckel \citep{2012MNRAS.426.1324B} interpolation grid by \citet{2015ApJS..216...29B}. However, application of \RM{} to millions of stars will still be a task for supercomputers and calls for even more improvements and speed-up in the fitting machinery.\\

\noindent {\bf Properties of the data set:~} We could show that \RM{} can provide potential and DF parameter estimates that are very accurate (i.e., unbiased) and precise in the the limit of large datasets, as long as the modelling assumptions are fulfilled.

In case the data set is affected by measurement uncertainties, the potential can still be recovered to high precision, as long as these uncertainties are perfectly known and distance uncertainties are negligible. For large proper motion uncertainties, e.g., $\delta \mu \sim 5~\text{mas yr}^{-1}$, the formal errors on the parameters are only twice as large as in the case of no measurement uncertainties. However, properly accounting for measurement uncertainties is computationally expensive.

For the results to be accurate within 2 sigma (for 10,000 stars), we need to know to within 10\% both the true stellar distances (at $r_\text{max} \leq 3~\text{kpc}$ and $\delta \mu \lesssim 2 ~ \text{mas yr}^{-1}$) and the true proper motion uncertainties (with $\delta \mu \lesssim 3 ~ \text{mas yr}^{-1}$).

We also found that the \emph{location} of the survey volume within the Galaxy matters little. At given sample size a larger survey \emph{volume} with large coverage in \emph{both radial and vertical} direction will give the tightest constraints on the model parameters.

Surprisingly, (cf. \citealt{2013A&ARv..21...61R}) \RM{} seems to be very robust against misjudgements of the spatial data selection function. We speculate that this is because missing stars in the data set do not affect the measured rotation curve, which contains information about the potential.

We found indications that populations of different scale lengths and temperature probe different regions of the Galaxy best. This supports the approach by BR13, who constrained for each \MAP{} the surface mass density only at one single best radius to account for missing flexibility in their potential model. While cooler populations probe to Galaxy rotation curve better and hotter populations are less sensitive to pollution, overall stellar populations of different kinematic temperature seem to be equally well-suited for dynamical modelling.\\

%\subsection{Data Deviations from the Modelling Assumptions about the Distribution Function and the Potential}

\noindent {\bf Deviations from the DF assumption:~} \RM{} assumes that stellar sub-populations can be described by simple DFs. We investigated how much the modelling would be affected if the assumed family of DFs would differ from the star's true DF.

In Example 1 in Section \ref{sec:results_mixedDFs} we considered true stellar DFs being i) hot with less stars at small radii and more stars with low velocities than assumed (reddish data sets in Figure \ref{fig:isoSphFlexMix_mockdata_residuals}), or ii) cool with broader velocity dispersion wings and less stars at large radii than assumed (bluish data sets). We find that case i) would give more reliable results for the potential parameter recovery.

Binning of stars into \MAPs{} in $[\alpha/\mathrm{Fe}]$ and $[\mathrm{Fe}/\mathrm{H}]$, as done by BR13, could introduce biases due to abundance errors or too large bin sizes---always assuming \MAPs{} follow simple DF families (e.g., the qDF). In Example 2 in Section \ref{sec:results_mixedDFs} we found that, in the case of 20,000 stars per bin, differences of $20\%$ in the qDF parameters of two neighbouring bins can still give quite good constraints on the potential parameters.

The relative difference in the qDF parameters $\sigma_{R,0}$ and $\sigma_{z,0}$ of neighbouring \MAPs{} in Figure 6 of BR13 (which have bin sizes of $[\mathrm{Fe}/\mathrm{H}] = 0.1$ dex and $\Delta [\alpha/\mathrm{Fe}] = 0.05$ dex) are indeed smaller than $20\%$. Figure \ref{fig:isoSphFlexMixCont} and \ref{fig:isoSphFlexMixDiff} suggest that especially the tracer scale length $h_R$ needs to be recovered to get the potential right. For this parameter however the bin sizes in Figure 6 of BR13 might not yet be small enough to ensure no more than $20\%$ of difference in neighbouring $h_R$.

The qDF is a specific example for a simple DF for stellar sub-populations which we used in this paper. But it is not essential for the \RM{} approach. Future studies might apply slight alternatives or completely different DFs to data.\\


\noindent {\bf Gravitational potential beyond the parametrized functions considered:~} In addition to the DF, \RM{} also assumes a parametric model for the gravitational potential. We test how using a potential of St\"{a}ckel form (\texttt{KKS-Pot}, \citealt{1994AA...287...43B}) affects the \RM{} analysis of mock data from a different potential family with halo, bulge and exponential disk. The potential recovery is quite successful: We properly reproduce the mock data distribution in configuration space; and the best fit potential is---within the limits of the model---as close as it gets to the true potential, even outside of the observation volume of the stellar tracers. 

For as many as 20,000 stars constraints become already so tight, that it should presumably be possible to distinguish between different parametric MW potential models (e.g., the \texttt{MW13-Pot} used by BR13 and the \texttt{KKS-Pot}).

BR13 fitted a MW-like model potential and calculated actions using the St\"{a}ckel approximation \citep{2012MNRAS.426.1324B}; in this case study we directly fitted a St\"{a}ckel potential to the data, with exact actions in the model potential. The latter is computationally much less expensive due to the simple analytic form for the potential. It would also allow flexibility by expressing the MW potential as a superposition of many more simple Kuzmin-Kutuzov St\"{a}ckel components (\citet{2003MNRAS.340..752F} used for example 3 components). The former approach by BR13 however allows to parametrize the potential with intuitive and physically motivated building blocks (exponential disks, power-law dark matter halo etc.). While both approaches are formally similar, it remains to decide which is better.\\

\noindent {\bf Different modelling approaches using action-based DFs:~} BR13 have focussed on \MAPs{} for a number of reasons: First, they seem to permit simple DFs \citep{2012ApJ...751..131B,2012ApJ...755..115B,2012ApJ...753..148B}, i.e., approximately qDFs \citep{2013MNRAS.434..652T}. Second, all stars must orbit in the same potential. While each \MAP{} can yield different DF parameters, it will also provide a (statistically) independent estimate of the potential. This allows for a valuable cross-checking reference. In some sense, the\RM{} approach focusses on constraining the potential, treating the DF parameters as nuisance parameters. That we were able to show in this work that \RM{} results are quite robust to the form of the DF not being entirely correct motivates this approach further. 

The main drawback is that---for reasons of galaxy and chemical evolution---the DF properties are astrophysically linked between different \MAPs{}. Ultimately, the goal is to do a consistent chemodynamical model that simultaneously fits the potential and $\text{DF}(\vect{J},\text{[X/H]})$ (where [X/Fe] denotes the whole abundance space) with a full likelihood analysis. This has not yet been attempted with \RM{}, because the behaviour is quite complex. 

Since the first application of \RM{} by BR13 there have been two similar efforts to constrain the Galactic potential and/or orbit DF:

\citet{2014MNRAS.445.3133P} fitted both potential and a $f(\vect{J})$ to giant stars from the RAVE survey \citep{2006AJ....132.1645S} and the vertical stellar number density profiles in the disk by \citet{2008ApJ...673..864J}. They did not include any chemical abundances in the modelling. Instead, they used a superposition of action-based DFs to describe the overall stellar distribution at once: a superposition of qDFs for cohorts in the thin disk, a single qDF for the thick disk stars and an additional DF for the halo stars. Taking proper care of the selection function requires a full likelihood analysis, which is computationally expensive. \citet{2014MNRAS.445.3133P} choose to circumvent by directly fitting a) histograms of the three velocity components in eight spatial bins to the velocity distribution predicted by the DF and b) the vertical density profile predicted by the DF to the profiles by \citet{2008ApJ...673..864J}. The vertical force profile of their best fit mass model nicely agrees with the results from BR13 for $R>6.6~\text{kpc}$. The disadvantage of their approach is, that by binning the stars spatially, a lot of information is not used.

\citet{2015MNRAS.449.3479S} have focussed on understanding the abundance-dependence of the DF, relying on a fiducial potential. They developed extended distribution functions (eDF), i.e., functions of both actions and metallicity for a superposition of thin and thisk disk, each consisting of several cohorts described by qDFs, a DF for the halo, a functional form of the metallicity of the interstellar medium at the time of birth, and a simple prescription for radial migration. They applied a full likelihood analysis accounting for selection effects and found a best fit for the eDF in the fixed fiducial potential by \citet{1998MNRAS.294..429D} to the stellar phase-space data of the Geneva-Copenhagen Survey \citep{2004A&A...418..989N,2009A&A...501..941H}, metallicity determinations by \citet{2011A&A...530A.138C} and the stellar density curves by \citet{1983MNRAS.202.1025G}. Their best fit predicted the velocity distribution of SEGUE G-dwarfs \citep{2014ApJS..211...17A} quite well, but had biases in the metallicity distribution, which they accounted to being a problem with the SEGUE metallicities. \\

%\subsection{On the Assumption of Axisymmetry}

\noindent {\bf Future work:~} We know that real galaxies, including the MW, are not axisymmetric. Using N-body models, we will explore in a subsequent paper how the recovery of the gravitational potential with \RM{} will be affected when data from a non-axisymmetric system get interpreted through axisymmetric models. In this context further investigations of questions that came up in Section \ref{sec:results_incompR} (``How much of the information on the potential is stored in the rotation curve?'') and earlier in Section \ref{sec:discussionsummary} (``What is better: fitting a MW-like potential using approximate St\"ackel Actions, or fitting a St\"ackel potential to the MW using exact Actions?'') should also be conducted.