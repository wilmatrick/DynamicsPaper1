\subsection{Effect of measurement errors on recovery of potential?} \label{sec:results_errors}

[TO DO]

\paragraph{Collection tests and plots (tests are still running on the cluster)}

\begin{itemize}
\item \emph{Plot 1:} number of MC samples needed for the error convolution vs. maximum velocity error inside the observed volume, such that a given accuracy in potential and qDF parameters is reached. Similar to what I had on the poster. However, we still haven't tested, if this plot depends on: hotness of stars and or umber of stars.

\item \emph{Plot 2:} 2 columns of panels (one row for each parameter), bias vs. standard error. First column: only proper motion and vlos errors $\longrightarrow$ shows that our error convolution works and should be bias free, plus, when knowing the errors perfectly we can get a perfect deconvolution and tight constraints. Second column: proper motion, vlos and distance modulus errors $\longrightarrow$ shows that for too large proper motion and distance errors our approximation for the error convolution does not work anymore.

\end{itemize}

\paragraph{Convergence of the error integral.} In \S \ref{sec:likelihood} we introduced how we convolve the model probability with the measurement errors. In the absence of distance errors the accuracy of the parameter recovery is limited by an insufficient MC sampling of the convolution integral in Eq. (\ref{errorconv}). Test \textcircled{6} in Table \ref{tbl:tests} and Fig. \ref{fig:isoSphFlexErrConv_MC_vs_error} investigate how many MC samples are needed, given the size of the velocity error, for the integral to be accurate within certain limits:
\\For each $\delta \mu \in [2,3,4,5] \text{mas yr}^{-1}$ we set up four mock data sets and evaluated the likelihood for different $N_\text{error}$. We used $N_\text{conv} :=$ 800 and 1200 MC samples to calculate the numerically converged likelihood for proper motion errors $\delta \mu \leq 3 \text{mas yr}^{-1}$ and $\delta \mu > 3 \text{mas yr}^{-1}$, respectively. We determined the mean bias 
\begin{equation*}
\text{BIAS}(N_\text{error},\delta \mu) \equiv \frac{1}{4} \sum_{j=1}^4 \left[ \langle p_i \rangle (N_\text{error},\delta \mu)\right]_j - \left[ \langle p_i \rangle (N_\text{conv},\delta \mu)\right]_j,
\end{equation*}
where $\left[ \langle p_i \rangle (N_\text{error},\delta \mu)\right]_j$ is the best estimate for the $i$-th model parameter $p_i \in \pmodel$ from the analysis of the $j$-th mock data realisation with $\delta \mu$ using $N_\text{error}$ MC samples. From this we then generated the curves $N_{\text{error},i} (\delta v_\text{max},\text{BIAS})$ in Fig. \ref{fig:isoSphFlexErrConv_MC_vs_error} by linear interplolation, that show how many MC samples are needed for parameter $p_i$ given a velocity error and a systematic bias in units of the standard error (SE) of the estimate. The proper motion error $\delta \mu$ translates to a velocity error according to 
\begin{equation}
\delta v_\text{max} [\text{km s}^{-1}] \equiv 4.74047 \cdot r_\text{max}[\text{kpc}] \cdot \delta \mu [\text{mas yr}^{-1}], \label{eq:vmax}
\end{equation}
where $r_\text{max}$ is the maximum distance of stars. We find in Fig. \ref{fig:isoSphFlexErrConv_MC_vs_error} the relation
\begin{equation*}
N_{\text{error},i} (\delta v_\text{max},\text{BIAS}) \propto \left( \delta v_\text{max} \right)^2.
\end{equation*}
Fig. \ref{fig:isoSphFlexErrConv_MC_vs_error} also demonstrates that different model parameters do not have the same sensitivity to the numerical inaccuracies introduced by insufficient sampling. 



\paragraph{Underestimation of the proper motion error.} We found that in case we perfectly knew the measurement errors (and the distance error is negligible), the convolution of the model probability with the measurement errors gives precise and accurate constraints on the model parameters - even if the error itself is quite large. Now we investigate what would happen if the quoted measurement errors, e.g. the proper motion errors, were actually smaller than the true errors. Figure \ref{fig:isoSphFlexErrSyst} shows the case for two different stellar populations and an error underestimation of 10\% and 50\%. 
\\Overall the parameter recovery gets worse the larger the proper motion error and the stronger the underestimation. The relation between the bias due to error misjudgment and the size of the proper motion error seems to be linear.
\\For the recovery of the isochrone potential scale length $b$ the hotness of the population does not matter (see lower left panel in Figure \ref{fig:isoSphFlexErrSyst}). The circular velocity $v_\text{circ}(R_\odot)$ is, as always, better measured by cooler than by hotter populations (see upper left panel in Figure \ref{fig:isoSphFlexErrSyst}). 
\\We find that the recovery of the qDF parameters on the other hand is more strongly affected by the misjudgment of the velocity error for \emph{cooler} stellar popluations. The measured velocity dispersion is the convolution of the intrinsic dispersion with the measurement errors. If the proper motion error is underestimated, the deconvolved velocity dispersion is larger than the intrinsic velocity dispersion and the relative difference is bigger for a cooler population (see upper right panel for $\sigma_z$ in Figure \ref{fig:isoSphFlexErrSyst}). The intrinsic velocity dispersion is also cooler at larger radii than at smaller radii, therefore the deconvolved dispersion is overestimated more strongly at large $R$ and the velocity dispersion scale length will be overestimated as well (see lower left panel for $h_{\sigma_z}$ in Figure \ref{fig:isoSphFlexErrSyst}). We get analogous results for the qDF parameters $\sigma_R$ and $h_{\sigma_R}$. The recovery of the tracer density scale length $h_R$ is not affected by the misjudgment of velocity errors. 
\\The most important and encouraging result from Figure \ref{fig:isoSphFlexErrSyst} is, that for an underestimation of $10\%$ the bias is still $\lesssim 2 \sigma$ - even for proper motion errors of $3$ mas/yr.

%=============================================================

\begin{figure*}
\plotone{figs/isoSphFlexErrConv_MC_vs_error.eps}
\caption{Number of Monte Carlo (MC) samples $N_\text{error}$ needed for the numerical error convolution in Eq. (\ref{eq:errorconv}), given the maximum velocity error $\delta v_\text{max}$ in the sample to reach a given accuracy.  An insufficient sampling of the convolution integral leads to systematic biases in the reconstruction of the true model parameters. The size of the bias is color coded as indicated in the legend and is given in units of the standard error (SE).  The model parameters, marked by different symbols, have different sensitivities to the numerical inaccuracy of the error convolution, therefore the range in $N_\text{error}$ for the same given bias. Here we assume that the distance error is zero and the proper motion error $\delta \mu$ translates to a velocity error according to Eq. (\ref{eq:vmax}) and $\delta v_\text{los} \ll \delta v_\text{max}$. All model parameters are listed in Table \ref{tbl:tests} as Test \textcircled{6}. The number of MC samples needed increases with the velocity error as $N_\text{error} \propto \left( \delta v_\text{max} \right)^2$, as can be seen especially well in the inset figure for the potential parameter $v_\text{circ}(R_\odot)$. All lines are fits of this functional form to each four points derived for a given model parameter (symbol) and bias (color). The large scatter in the points comes from low number statistics and errors introduced by linear interpolation of the bias vs. $N_\text{error}$ relation found from the analyses.}
\label{fig:isoSphFlexErrConv_MC_vs_error}
\end{figure*}


%=============================================================

\begin{figure*}
\plotone{figs/isoSphFlexErrConv_bias_vs_SE.eps}
\caption{[TO DO: Caption]}
\label{fig:isoSphFlexErrConv_bias_vs_SE}
\end{figure*}




%=============================================================

\begin{figure*}
\plotone{figs/isoSphFlexErrSyst_offset_vs_error.eps}
\caption{Effect of an systematic underestimation of proper motion errors in the recovery of the model parameters. The true model parameters used to create the mock data are summarized as Test \textcircled{11} in Table \ref{tbl:tests}, four of them are given on the $y$-axes and the true values are indicated as black dashed lines. The velocities of the mock data were perturbed according to Gaussian errors in the $\alpha$ and $\delta$ proper motions as indicated on the $x$-axis.   The circles and triangles are the best fit parameters of several mock data set assuming the proper motion error, with which the model probability was convolved, was underestimated in the analysis by 10\% or 50\%, respectively. The error bars correspond to $1\sigma$ confidence. The lines connect the mean of each two data realisations and are just guides to the eyes.}
\label{fig:isoSphFlexErrSyst}
\end{figure*}

%=============================================================